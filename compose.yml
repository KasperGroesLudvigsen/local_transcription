services:
  transcription:
    build: .
    runtime: nvidia
    environment:
      - NVIDIA_VISIBLE_DEVICES=all
      - NVIDIA_DRIVER_CAPABILITIES=compute,utility
      - HF_TOKEN=${HF_TOKEN}
    env_file:
      - .env
    ports:
      - "8000:8000"
    volumes:
      - hf_cache:/root/.cache/huggingface
    ipc: host
    ulimits:
      memlock: -1
      stack: 67108864
    restart: unless-stopped

volumes:
  hf_cache:
